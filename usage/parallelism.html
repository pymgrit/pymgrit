

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Parallelism &mdash; PyMGRIT 1.0.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Advanced usage" href="advanced.html" />
    <link rel="prev" title="Examples" href="examples.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> PyMGRIT
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Parallelism</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#time-parallelism">Time parallelism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#output-function">Output function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scaling-results">Scaling results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#space-time-parallelism">Space &amp; time parallelism</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../applications/dahlquist.html">Dahlquist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/brusselator.html">Brusselator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/arenstorf_orbit.html">Arenstorf orbit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/heat_equation.html">Heat Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/advection.html">Advection</a></li>
</ul>
<p class="caption"><span class="caption-text">Coupling</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../coupling/firedrake.html">Firedrake</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coupling/petsc.html">PETSc</a></li>
</ul>
<p class="caption"><span class="caption-text">Help</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../help/faq.html">Frequently Asked Questions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyMGRIT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Parallelism</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/usage/parallelism.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="parallelism">
<h1>Parallelism<a class="headerlink" href="#parallelism" title="Permalink to this headline">¶</a></h1>
<p>This page contains short examples that demonstrate the parallel usage of PyMGRIT.</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#time-parallelism">Time parallelism</a></p></li>
<li><p><a class="reference internal" href="#space-time-parallelism">Space &amp; time parallelism</a></p></li>
</ul>
</div></blockquote>
<div class="section" id="time-parallelism">
<h2>Time parallelism<a class="headerlink" href="#time-parallelism" title="Permalink to this headline">¶</a></h2>
<p>Use <cite>mpirun</cite> to run an example in parallel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mpiexec</span> <span class="o">-</span><span class="n">np</span> <span class="mi">2</span> <span class="n">python3</span> <span class="n">example_dahlquist</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<div class="section" id="output-function">
<h3>Output function<a class="headerlink" href="#output-function" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/pymgrit/pymgrit/tree/master/examples/example_output_fcn.py">example_output_fcn.py</a></p>
<p>In this example, we show how to use the output function for a parallel run and save the solution after each iteration.
Each process calls the function, so the file of each process must be unique. We use the rank to distinguish the files.
We save the solution and the time point in a list for each local point of one process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">output_fcn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Set path to solution; here, we include the iteration number in the path name</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;results/&#39;</span> <span class="o">+</span> <span class="s1">&#39;brusselator&#39;</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solve_iter</span><span class="p">)</span>
    <span class="c1"># Create path if not existing</span>
    <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Save solution to file.</span>
    <span class="c1"># Useful member variables of MGRIT solver:</span>
    <span class="c1">#   - self.t[0]           : local fine-grid (level 0) time interval</span>
    <span class="c1">#   - self.index_local[0] : indices of local fine-grid (level 0) time interval</span>
    <span class="c1">#   - self.u[0]           : fine-grid (level 0) solution values</span>
    <span class="c1">#   - self.comm_time_rank : Time communicator rank</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/brusselator-rank&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comm_time_rank</span><span class="p">),</span>
            <span class="p">[[[</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_local</span><span class="p">[</span><span class="mi">0</span><span class="p">]]])</span>  <span class="c1"># Solution and time at local time points</span>
</pre></div>
</div>
<p>Then, we solve the problem in the usual way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create two-level time-grid hierarchy for the Brusselator system</span>
<span class="n">brusselator_lvl_0</span> <span class="o">=</span> <span class="n">Brusselator</span><span class="p">(</span><span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">641</span><span class="p">)</span>
<span class="n">brusselator_lvl_1</span> <span class="o">=</span> <span class="n">Brusselator</span><span class="p">(</span><span class="n">t_interval</span><span class="o">=</span><span class="n">brusselator_lvl_0</span><span class="o">.</span><span class="n">t</span><span class="p">[::</span><span class="mi">20</span><span class="p">])</span>

<span class="c1"># Set up the MGRIT solver using the two-level hierarchy and set the output function</span>
<span class="n">mgrit</span> <span class="o">=</span> <span class="n">Mgrit</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="p">[</span><span class="n">brusselator_lvl_0</span><span class="p">,</span> <span class="n">brusselator_lvl_1</span><span class="p">],</span> <span class="n">output_fcn</span><span class="o">=</span><span class="n">output_fcn</span><span class="p">,</span> <span class="n">output_lvl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cf_iter</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Solve Brusselator system</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">mgrit</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>The last step is to plot the solution for each iteration. Therefore, all files have to be loaded and the solution has to
be assembled in the correct order. To determine the correct order, we use the corresponding time points:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the MGRIT approximation of the solution after each iteration</span>
<span class="k">if</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">Get_rank</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="c1"># Dynamic images</span>
    <span class="n">iterations_needed</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;conv&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">iterations_needed</span> <span class="o">//</span> <span class="n">cols</span> <span class="o">+</span> <span class="n">iterations_needed</span> <span class="o">%</span> <span class="n">cols</span>
    <span class="n">position</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">iterations_needed</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations_needed</span><span class="p">):</span>
        <span class="c1"># Load each file and add the loaded values to sol</span>
        <span class="n">sol</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;results/brusselator/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">sol</span> <span class="o">+=</span> <span class="n">data</span>
        <span class="c1"># Sort the solution list by the time</span>
        <span class="n">sol</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">tup</span><span class="p">:</span> <span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1"># Get the solution values</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">])</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">position</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="c1"># Plot the two solution values at each time point</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">values</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">values</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="scaling-results">
<h3>Scaling results<a class="headerlink" href="#scaling-results" title="Permalink to this headline">¶</a></h3>
<p>In the following we present strong scaling results for applying a five-level MGRIT V-cycle solver with FCF-relaxation
and nested iterations to a 2D heat equation example. The problem setup is as follows:</p>
<ul>
<li><p>Space-time domain: <span class="math notranslate nohighlight">\([0, 1] \times [0, 1] \times [0, 5]\)</span></p></li>
<li><p>Thermal conductivity: <span class="math notranslate nohighlight">\(a = 1\)</span></p></li>
<li><p>Right-hand side: <span class="math notranslate nohighlight">\(b(x,y,t) = -\sin(x) * \sin(y) * (\sin(t) - 2 * \cos(t))\)</span></p></li>
<li><p>Homogeneous Dirichlet boundary conditions in space</p></li>
<li><p>Initial condition: <span class="math notranslate nohighlight">\(u(x,y,0) = 0\)</span></p></li>
<li><p>Discretization:</p>
<ul class="simple">
<li><p>centered finite differences in space</p></li>
<li><p>backward Euler in time</p></li>
<li><p>discrete problem size: <span class="math notranslate nohighlight">\(101 \times 51 \times 8193\)</span></p></li>
</ul>
</li>
<li><p>5-level MGRIT V-cycles with FCF-relaxation and nested iterations</p></li>
<li><p>Coarsening strategy:</p>
<ul class="simple">
<li><p>factor-8 coarsening on finest level</p></li>
<li><p>factor-4 coarsening on all coarse levels</p></li>
</ul>
</li>
<li><p>Source code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pymgrit.heat.heat_2d</span> <span class="kn">import</span> <span class="n">Heat2D</span>
<span class="kn">from</span> <span class="nn">pymgrit.core.mgrit</span> <span class="kn">import</span> <span class="n">Mgrit</span>

<span class="k">def</span> <span class="nf">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="n">heat0</span> <span class="o">=</span> <span class="n">Heat2D</span><span class="p">(</span><span class="n">x_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rhs</span><span class="o">=</span><span class="n">rhs</span><span class="p">,</span> <span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
               <span class="n">nt</span><span class="o">=</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">13</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">heat1</span> <span class="o">=</span> <span class="n">Heat2D</span><span class="p">(</span><span class="n">x_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rhs</span><span class="o">=</span><span class="n">rhs</span><span class="p">,</span> <span class="n">t_interval</span><span class="o">=</span><span class="n">heat0</span><span class="o">.</span><span class="n">t</span><span class="p">[::</span><span class="mi">8</span><span class="p">])</span>
<span class="n">heat2</span> <span class="o">=</span> <span class="n">Heat2D</span><span class="p">(</span><span class="n">x_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rhs</span><span class="o">=</span><span class="n">rhs</span><span class="p">,</span> <span class="n">t_interval</span><span class="o">=</span><span class="n">heat1</span><span class="o">.</span><span class="n">t</span><span class="p">[::</span><span class="mi">4</span><span class="p">])</span>
<span class="n">heat3</span> <span class="o">=</span> <span class="n">Heat2D</span><span class="p">(</span><span class="n">x_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rhs</span><span class="o">=</span><span class="n">rhs</span><span class="p">,</span> <span class="n">t_interval</span><span class="o">=</span><span class="n">heat2</span><span class="o">.</span><span class="n">t</span><span class="p">[::</span><span class="mi">4</span><span class="p">])</span>
<span class="n">heat4</span> <span class="o">=</span> <span class="n">Heat2D</span><span class="p">(</span><span class="n">x_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rhs</span><span class="o">=</span><span class="n">rhs</span><span class="p">,</span> <span class="n">t_interval</span><span class="o">=</span><span class="n">heat3</span><span class="o">.</span><span class="n">t</span><span class="p">[::</span><span class="mi">4</span><span class="p">])</span>

<span class="n">mgrit</span> <span class="o">=</span> <span class="n">Mgrit</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="p">[</span><span class="n">heat0</span><span class="p">,</span> <span class="n">heat1</span><span class="p">,</span> <span class="n">heat2</span><span class="p">,</span> <span class="n">heat3</span><span class="p">,</span> <span class="n">heat4</span><span class="p">])</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>The parallel tests were performed on an Intel Xeon Phi Cluster consisting of 272 1.4 GHz Intel Xeon Phi processors.</p></li>
<li><p>Between two and 128 processors were used for parallelization in time</p></li>
<li><p>Runtimes are compared to sequential time-stepping</p></li>
</ul>
<p>Total (setup + solve) runtimes:</p>
<div class="figure align-default">
<img alt="strong scaling results" src="../_images/strong_scaling.png" />
</div>
</div>
</div>
<div class="section" id="space-time-parallelism">
<h2>Space &amp; time parallelism<a class="headerlink" href="#space-time-parallelism" title="Permalink to this headline">¶</a></h2>
<p>To be done.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="advanced.html" class="btn btn-neutral float-right" title="Advanced usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="examples.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Jens Hahne and Stephanie Friedhoff

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>